<template>
  <div :ref="ref" class="yh-chart-content" :id="chartId"></div>
</template>
<script>
import Graph from './chart.js'
import { uuid } from '../../../util/index.js'
export default {
  name: 'YhChartContent',
  props: {
    chartOptions: Object
  },
  watch: {
    chartOptions: {
      handler () {
        this.graph.setData(this.chartOptions)
      },
      deep: true
    }
  },
  data () {
    const id = uuid()
    return {
      graph: '',
      ref: 'yh-chart-content',
      chartId: `yh-chart-content-${id}`,
      el: null
    }
  },
  mounted () {
    this.init()
  },
  methods: {
    destroy () {
      this.graph.destroy()
      this.graph = null
    },
    init () {
      this.el = document.getElementById(this.chartId)
      this.graph = new Graph(this.el)
      this.graph.setData(this.chartOptions)
      this.el.addEventListener('resize', this.graph.resize)
    }
  },
  beforeDestroy () {
    this.el.removeEventListener('resize', this.graph.resize)
    this.graph.destroy()
    this.graph = null
  }
}
</script>
<style lang="less">
.yh-chart-content{
  height: 100%;
  width: 100%;
}
</style>
